import random
import string

# Prompt user for the message to encode or decode
st = input("Enter Message: ")
words = st.split(" ")

# Ask whether to encode (1) or decode (0)
coding = input("1 for Coding or 0 for Decoding: ")
coding = True if coding == "1" else False

if coding:
    # Encoding Process
    nwords = []
    for word in words:
        if len(word) >= 3:
            # Generate two random strings of length 3
            r1 = ''.join(random.choices(string.ascii_letters + string.digits, k=3))
            r2 = ''.join(random.choices(string.ascii_letters + string.digits, k=3))
            # Rearrange the word and add the random strings
            stnew = r1 + word[1:] + word[0] + r2
            nwords.append(stnew)
        else:
            # Reverse short words
            nwords.append(word[::-1])
    
    # Join all the encoded words and print
    print(" ".join(nwords))
else:
    # Decoding Process
    nwords = []
    for word in words:
        if len(word) >= 3:
            # Remove the 3 random characters and swap the first and last characters
            stnew = word[3:-3]  # Remove the random prefix and suffix
            stnew = stnew[-1] + stnew[:-1]  # Swap the first and last character
            nwords.append(stnew)
        else:
            # Reverse short words
            nwords.append(word[::-1])
    
    # Join all the decoded words and print
    print(" ".join(nwords))
